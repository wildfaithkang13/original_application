<html>
<head>
</head>
<body>
<%= javascript_include_tag 'assets/modi' %>
<p id="notice"><%= notice %></p>
<h1>オリジナルアプリindex</h1>

<!-- Google Mapの表示に関する設定-->
<style type="text/css">
 #map { height: 1000px; /* 元々のデフォルト値は400px*/
 margin-left:auto;    /* 左側マージンを自動的に空ける */
 margin-right:auto;   /* 右側マージンを自動的に空ける */
 text-align:left;     /* 中身を左側表示に戻す */
 width: 80%;}
</style>
  <div id="map"></div>
  <h1>GoogleMap表示のページ</h1>
<!-- ページ読み込んだ時には現在地をデフォルトとして表示させる -->
<script type="text/javascript">
function initMap() {

  var test ={lat: <%= @latitude %>, lng: <%= @longitude %>};
  var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 15,
    /* 設定した住所が地図の真ん中にくるように設定*/
    center: test
    /* center: {lat: -34.397, lng: 150.644} */
  });
  var transitLayer = new google.maps.TransitLayer();
  /* 地図の表示設定 */
  transitLayer.setMap(map);

  var contentString = '住所：<%= @address %>';
  var infowindow = new google.maps.InfoWindow({
    /*吹き出しを設定する*/
    content: contentString
  });

  var marker = new google.maps.Marker({
    /* このポジションがピンをさす場所を表している */
    position:test,
    map: map,
    title: contentString
  });

  marker.addListener('click', function() {
    infowindow.open(map, marker);
  });
}
 </script>
 <script async defer
   src="https://maps.googleapis.com/maps/api/js?v=3.exp&key=<%= @gmapkey %>&callback=initMap">
 </script>
<br>

<%= form_tag root_path, :method => :get do %>
  <p>
    <%= text_field_tag :address, params[:address] %>
    <%= submit_tag "Search Near", :name => nil %>
<% end %>

</body>
</html>
